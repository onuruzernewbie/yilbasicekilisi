
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>YÄ±lbaÅŸÄ± Ã‡ekiliÅŸi 2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#e53935" />
  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: radial-gradient(circle at top, #ffebee 0, #1b2735 55%, #000 100%);
      color: #fff;
      padding: 16px;
      box-sizing: border-box;
    }
    .card {
      background: rgba(0, 0, 0, 0.7);
      border-radius: 16px;
      padding: 20px 18px 24px;
      max-width: 480px;
      width: 100%;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
      text-align: center;
      backdrop-filter: blur(6px);
    }
    h1 {
      margin: 0 0 8px;
      font-size: 1.5rem;
    }
    h2 {
      margin: 16px 0 8px;
      font-size: 1.1rem;
    }
    p {
      margin: 4px 0;
      font-size: 0.95rem;
    }
    .highlight {
      font-size: 1.4rem;
      margin-top: 12px;
    }
    .highlight span {
      font-weight: 700;
      color: #ffeb3b;
    }
    textarea {
      width: 100%;
      margin-top: 8px;
      padding: 8px;
      border-radius: 8px;
      border: none;
      font-size: 0.85rem;
      box-sizing: border-box;
      resize: vertical;
    }
    .info {
      font-size: 0.8rem;
      opacity: 0.85;
      margin-top: 6px;
    }
    .done {
      margin-top: 14px;
      font-size: 1rem;
      font-weight: 600;
      color: #a5d6a7;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>ğŸ„ YÄ±lbaÅŸÄ± Ã‡ekiliÅŸi 2025 ğŸ</h1>
    <p>Zincirli hediye Ã§ekiliÅŸi. Bu linki <strong>sÄ±rayla</strong> aÃ§Ä±n.</p>

    <div id="result" class="highlight"></div>

    <div id="nextBox" style="margin-top: 14px;"></div>

    <p class="info">
      AynÄ± linki yeniden aÃ§san bile sana Ã§Ä±kan kiÅŸi deÄŸiÅŸmez.<br />
      Yeni linki sadece sÄ±radaki kiÅŸiye gÃ¶nder.
    </p>
  </div>

  <script>
    // Sabit isim listesi (15 kiÅŸi)
    const initialNames = [
      "Onur",
      "TuÄŸÃ§e",
      "Atlas",
      "Ã–zercan",
      "Seda",
      "Mustafa",
      "Ä°lknur",
      "GÃ¼lnur",
      "Ä°lter",
      "Ä°laynur",
      "Delfin",
      "GÃ¼lay",
      "Recep",
      "Beren",
      "Kayra"
    ];

    // URL parametrelerini oku
    const params = new URLSearchParams(window.location.search);
    const leftParam = params.get("left");
    const mineParam = params.get("mine");

    function parseList(str) {
      try {
        return JSON.parse(str);
      } catch (e) {
        return null;
      }
    }

    // Kalan isim listesi (yoksa ilk aÃ§an kiÅŸi)
    let remainingList = leftParam ? parseList(leftParam) : initialNames.slice();
    if (!Array.isArray(remainingList) || remainingList.length === 0) {
      remainingList = initialNames.slice();
    }

    const resultDiv = document.getElementById("result");
    const nextBox = document.getElementById("nextBox");

    let myPerson = mineParam ? decodeURIComponent(mineParam) : null;

    if (!myPerson) {
      // Bu kiÅŸi iÃ§in ilk kez aÃ§Ä±lÄ±yorsa random kiÅŸi seÃ§
      const randomIndex = Math.floor(Math.random() * remainingList.length);
      myPerson = remainingList[randomIndex];

      // Bir sonraki kiÅŸi iÃ§in "kalanlar" listesinden seÃ§ileni Ã§Ä±kar
      const nextList = remainingList.slice();
      nextList.splice(randomIndex, 1);

      // SÄ±radaki kiÅŸiye gidecek yeni link
      let nextLinkText = "";
      if (nextList.length > 0) {
        const nextURL =
          window.location.origin +
          window.location.pathname +
          "?left=" +
          encodeURIComponent(JSON.stringify(nextList));
        nextLinkText = nextURL;
      }

      // Mevcut sayfanÄ±n URL'sine sadece benim kiÅŸimi iÅŸaretle (yeniden aÃ§sam aynÄ± kalsÄ±n)
      const newURL =
        window.location.pathname +
        "?mine=" +
        encodeURIComponent(myPerson) +
        "&left=" +
        encodeURIComponent(JSON.stringify(remainingList));

      window.history.replaceState(null, "", newURL);

      // Ekrana yaz
      resultDiv.innerHTML = `Sana Ã§Ä±kan kiÅŸi: <span>${myPerson}</span> ğŸ`;

      if (nextList.length > 0) {
        nextBox.innerHTML =
          "<h2>ğŸ“© SÄ±radaki kiÅŸiye gÃ¶ndereceÄŸin link:</h2>" +
          "<textarea readonly>" +
          nextLinkText +
          "</textarea>";
      } else {
        nextBox.innerHTML =
          "<p class='done'>ğŸ‰ Son kiÅŸiydin, Ã§ekiliÅŸ tamamlandÄ±!</p>";
      }
    } else {
      // Bu link zaten kullanÄ±lmÄ±ÅŸ, sadece sonucu gÃ¶ster
      resultDiv.innerHTML = `Sana Ã§Ä±kan kiÅŸi: <span>${myPerson}</span> ğŸ`;

      // Bu durumda da sÄ±radaki kiÅŸiye giden link (halen URL'deki left'e gÃ¶re)
      const nextList = remainingList.slice();
      if (nextList.length > 0) {
        const nextURL =
          window.location.origin +
          window.location.pathname +
          "?left=" +
          encodeURIComponent(JSON.stringify(nextList));
        nextBox.innerHTML =
          "<h2>ğŸ“© SÄ±radaki kiÅŸiye gÃ¶ndereceÄŸin link:</h2>" +
          "<textarea readonly>" +
          nextURL +
          "</textarea>";
      } else {
        nextBox.innerHTML =
          "<p class='done'>ğŸ‰ Son kiÅŸiydin, Ã§ekiliÅŸ tamamlandÄ±!</p>";
      }
    }

    // PWA service worker kaydÄ±
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker
          .register("sw.js")
          .catch((err) => console.log("Service worker hatasÄ±:", err));
      });
    }
  </script>
</body>
</html>
